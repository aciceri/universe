{
  "jobs": {
    "aarch64-linux/claude-desktop": {
      "runs-on": "native",
      "steps": [
        {
          "name": "Checkout repository",
          "uses": "actions/checkout@v4"
        },
        {
          "name": "Attic login",
          "run": "attic login sisko http://sisko.wg.aciceri.dev:8081 ${{secrets.ATTIC_SISKO_TOKEN}} --set-default"
        },
        {
          "name": "Build",
          "run": "nix build \".#checks.aarch64-linux.claude-desktop\" -L"
        },
        {
          "name": "Push to Attic",
          "run": "attic push sisko result"
        }
      ]
    },
    "aarch64-linux/configurations/nixos/sisko": {
      "runs-on": "native",
      "steps": [
        {
          "name": "Checkout repository",
          "uses": "actions/checkout@v4"
        },
        {
          "name": "Attic login",
          "run": "attic login sisko http://sisko.wg.aciceri.dev:8081 ${{secrets.ATTIC_SISKO_TOKEN}} --set-default"
        },
        {
          "name": "Build",
          "run": "nix build \".#checks.aarch64-linux.configurations/nixos/sisko\" -L"
        },
        {
          "name": "Push to Attic",
          "run": "attic push sisko result"
        }
      ]
    },
    "aarch64-linux/default-shell": {
      "runs-on": "native",
      "steps": [
        {
          "name": "Checkout repository",
          "uses": "actions/checkout@v4"
        },
        {
          "name": "Attic login",
          "run": "attic login sisko http://sisko.wg.aciceri.dev:8081 ${{secrets.ATTIC_SISKO_TOKEN}} --set-default"
        },
        {
          "name": "Build",
          "run": "nix build \".#checks.aarch64-linux.default-shell\" -L"
        },
        {
          "name": "Push to Attic",
          "run": "attic push sisko result"
        }
      ]
    },
    "aarch64-linux/mirror-checks": {
      "runs-on": "native",
      "steps": [
        {
          "name": "Checkout repository",
          "uses": "actions/checkout@v4"
        },
        {
          "name": "Attic login",
          "run": "attic login sisko http://sisko.wg.aciceri.dev:8081 ${{secrets.ATTIC_SISKO_TOKEN}} --set-default"
        },
        {
          "name": "Build",
          "run": "nix build \".#checks.aarch64-linux.mirror-checks\" -L"
        },
        {
          "name": "Push to Attic",
          "run": "attic push sisko result"
        }
      ]
    },
    "aarch64-linux/pre-commit": {
      "runs-on": "native",
      "steps": [
        {
          "name": "Checkout repository",
          "uses": "actions/checkout@v4"
        },
        {
          "name": "Attic login",
          "run": "attic login sisko http://sisko.wg.aciceri.dev:8081 ${{secrets.ATTIC_SISKO_TOKEN}} --set-default"
        },
        {
          "name": "Build",
          "run": "nix build \".#checks.aarch64-linux.pre-commit\" -L"
        },
        {
          "name": "Push to Attic",
          "run": "attic push sisko result"
        }
      ]
    },
    "aarch64-linux/treefmt": {
      "runs-on": "native",
      "steps": [
        {
          "name": "Checkout repository",
          "uses": "actions/checkout@v4"
        },
        {
          "name": "Attic login",
          "run": "attic login sisko http://sisko.wg.aciceri.dev:8081 ${{secrets.ATTIC_SISKO_TOKEN}} --set-default"
        },
        {
          "name": "Build",
          "run": "nix build \".#checks.aarch64-linux.treefmt\" -L"
        },
        {
          "name": "Push to Attic",
          "run": "attic push sisko result"
        }
      ]
    },
    "call-merge-pr": {
      "if": "${{ success() && github.ref == 'refs/heads/update-flake-lock' }}",
      "needs": [
        "aarch64-linux/claude-desktop",
        "aarch64-linux/configurations/nixos/sisko",
        "aarch64-linux/default-shell",
        "aarch64-linux/mirror-checks",
        "aarch64-linux/pre-commit",
        "aarch64-linux/treefmt",
        "x86_64-linux/claude-desktop",
        "x86_64-linux/configurations/nixos/picard",
        "x86_64-linux/configurations/nixos/pike",
        "x86_64-linux/default-shell",
        "x86_64-linux/mirror-checks",
        "x86_64-linux/pre-commit",
        "x86_64-linux/treefmt"
      ],
      "runs-on": "native",
      "secrets": {
        "SEVENOFNINE_TOKEN": "${{secrets.SEVENOFNINE_TOKEN}}"
      },
      "uses": "./.forgejo/workflows/merge-pr.yaml"
    },
    "mirror-checks": {
      "if": "always()",
      "needs": [
        "aarch64-linux/claude-desktop",
        "aarch64-linux/configurations/nixos/sisko",
        "aarch64-linux/default-shell",
        "aarch64-linux/mirror-checks",
        "aarch64-linux/pre-commit",
        "aarch64-linux/treefmt",
        "x86_64-linux/claude-desktop",
        "x86_64-linux/configurations/nixos/picard",
        "x86_64-linux/configurations/nixos/pike",
        "x86_64-linux/default-shell",
        "x86_64-linux/mirror-checks",
        "x86_64-linux/pre-commit",
        "x86_64-linux/treefmt"
      ],
      "runs-on": "native",
      "steps": [
        {
          "name": "Checkout repository",
          "uses": "actions/checkout@v4"
        },
        {
          "env": {
            "FORGEJO_URL": "https://git.aciceri.dev",
            "GITHUB_TOKEN": "${{secrets.ACICERI_GITHUB_TOKEN}}"
          },
          "name": "Sync checks to GitHub",
          "run": "nix run .#mirror-checks -- --repo ${{forge.repository}} --commit ${{forge.sha}}"
        }
      ]
    },
    "x86_64-linux/claude-desktop": {
      "runs-on": "native",
      "steps": [
        {
          "name": "Checkout repository",
          "uses": "actions/checkout@v4"
        },
        {
          "name": "Attic login",
          "run": "attic login sisko http://sisko.wg.aciceri.dev:8081 ${{secrets.ATTIC_SISKO_TOKEN}} --set-default"
        },
        {
          "name": "Build",
          "run": "nix build \".#checks.x86_64-linux.claude-desktop\" -L"
        },
        {
          "name": "Push to Attic",
          "run": "attic push sisko result"
        }
      ]
    },
    "x86_64-linux/configurations/nixos/picard": {
      "runs-on": "native",
      "steps": [
        {
          "name": "Checkout repository",
          "uses": "actions/checkout@v4"
        },
        {
          "name": "Attic login",
          "run": "attic login sisko http://sisko.wg.aciceri.dev:8081 ${{secrets.ATTIC_SISKO_TOKEN}} --set-default"
        },
        {
          "name": "Build",
          "run": "nix build \".#checks.x86_64-linux.configurations/nixos/picard\" -L"
        },
        {
          "name": "Push to Attic",
          "run": "attic push sisko result"
        }
      ]
    },
    "x86_64-linux/configurations/nixos/pike": {
      "runs-on": "native",
      "steps": [
        {
          "name": "Checkout repository",
          "uses": "actions/checkout@v4"
        },
        {
          "name": "Attic login",
          "run": "attic login sisko http://sisko.wg.aciceri.dev:8081 ${{secrets.ATTIC_SISKO_TOKEN}} --set-default"
        },
        {
          "name": "Build",
          "run": "nix build \".#checks.x86_64-linux.configurations/nixos/pike\" -L"
        },
        {
          "name": "Push to Attic",
          "run": "attic push sisko result"
        }
      ]
    },
    "x86_64-linux/default-shell": {
      "runs-on": "native",
      "steps": [
        {
          "name": "Checkout repository",
          "uses": "actions/checkout@v4"
        },
        {
          "name": "Attic login",
          "run": "attic login sisko http://sisko.wg.aciceri.dev:8081 ${{secrets.ATTIC_SISKO_TOKEN}} --set-default"
        },
        {
          "name": "Build",
          "run": "nix build \".#checks.x86_64-linux.default-shell\" -L"
        },
        {
          "name": "Push to Attic",
          "run": "attic push sisko result"
        }
      ]
    },
    "x86_64-linux/mirror-checks": {
      "runs-on": "native",
      "steps": [
        {
          "name": "Checkout repository",
          "uses": "actions/checkout@v4"
        },
        {
          "name": "Attic login",
          "run": "attic login sisko http://sisko.wg.aciceri.dev:8081 ${{secrets.ATTIC_SISKO_TOKEN}} --set-default"
        },
        {
          "name": "Build",
          "run": "nix build \".#checks.x86_64-linux.mirror-checks\" -L"
        },
        {
          "name": "Push to Attic",
          "run": "attic push sisko result"
        }
      ]
    },
    "x86_64-linux/pre-commit": {
      "runs-on": "native",
      "steps": [
        {
          "name": "Checkout repository",
          "uses": "actions/checkout@v4"
        },
        {
          "name": "Attic login",
          "run": "attic login sisko http://sisko.wg.aciceri.dev:8081 ${{secrets.ATTIC_SISKO_TOKEN}} --set-default"
        },
        {
          "name": "Build",
          "run": "nix build \".#checks.x86_64-linux.pre-commit\" -L"
        },
        {
          "name": "Push to Attic",
          "run": "attic push sisko result"
        }
      ]
    },
    "x86_64-linux/treefmt": {
      "runs-on": "native",
      "steps": [
        {
          "name": "Checkout repository",
          "uses": "actions/checkout@v4"
        },
        {
          "name": "Attic login",
          "run": "attic login sisko http://sisko.wg.aciceri.dev:8081 ${{secrets.ATTIC_SISKO_TOKEN}} --set-default"
        },
        {
          "name": "Build",
          "run": "nix build \".#checks.x86_64-linux.treefmt\" -L"
        },
        {
          "name": "Push to Attic",
          "run": "attic push sisko result"
        }
      ]
    }
  },
  "name": "Build flake checks",
  "on": {
    "push": {},
    "workflow_dispatch": {}
  }
}
